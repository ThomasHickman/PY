{
    "downsampling": {},
    "summary": "Calculate genotype posterior likelihoods given panel data",
    "refwindow": {},
    "description": "\n\n <p>\n Given a VCF with genotype likelihoods from the HaplotypeCaller, UnifiedGenotyper, or another source which provides\n <b>unbiased</b> genotype likelihoods, calculate the posterior genotype state and likelihood given allele frequency\n information from both the samples themselves and input VCFs describing allele frequencies in related populations.</p>\n\n <p>The AF field will not be used in this calculation as it does not provide a way to estimate the confidence interval\n or uncertainty around the allele frequency, while AN provides this necessary information. This uncertainty is\n modeled by a Dirichlet distribution: that is, the frequency is known up to a Dirichlet distribution with\n parameters AC1+q,AC2+q,...,(AN-AC1-AC2-...)+q, where \"q\" is the global frequency prior (typically q << 1). The\n genotype priors applied then follow a Dirichlet-Multinomial distribution, where 2 alleles per sample are drawn\n independently. This assumption of independent draws is the assumption Hardy-Weinberg Equilibrium. Thus, HWE is\n imposed on the likelihoods as a result of CalculateGenotypePosteriors.</p>\n\n <h3>Input</h3>\n <p>\n     <ul>\n         <li>A VCF with genotype likelihoods, and optionally genotypes, AC/AN fields, or MLEAC/AN fields</li>\n         <li>(Optional) A PED pedigree file containing the description of the individuals relationships.</li>\n     </ul>\n </p>\n\n <p>\n A collection of VCFs to use for informing allele frequency priors. Each VCF must have one of\n </p>\n <ul>\n     <li>AC field and AN field</li>\n     <li>MLEAC field and AN field</li>\n     <li>genotypes</li>\n </ul>\n </p>\n\n <h3>Output</h3>\n <p>A new VCF with:</p>\n <ul>\n     <li>Genotype posteriors added to the genotype fields (\"PP\")</li>\n     <li>Genotypes and GQ assigned according to these posteriors</li>\n     <li>Per-site genotype priors added to the INFO field (\"PG\")</li>\n     <li>(Optional) Per-site, per-trio joint likelihoods (JL) and joint posteriors (JL) given as Phred-scaled probability\n  of all genotypes in the trio being correct based on the PLs for JL and the PPs for JP. These annotations are added to\n  the genotype fields.</li>\n </ul>\n\n <h3>Notes</h3>\n <p>\n Using the default behavior, priors will only be applied for each variants (provided each variant has at least 10\n called samples.) SNP sites in the input callset that have a SNP at the matching site in the supporting VCF will have\n priors applied based on the AC from the supporting samples and the input callset (unless the --ignoreInputSamples\n flag is used). If the site is not called in the supporting VCF, priors will be applied using the discovered AC from\n the input samples (unless the --discoveredACpriorsOff flag is used). Flat priors are applied for any non-SNP sites in\n the input callset.\n </p>\n\n <h3>Usage examples</h3>\n <h4>Inform the genotype assignment of NA12878 using the 1000G Euro panel</h4>\n <pre>\n java -jar GenomeAnalysisTK.jar \\\n   -T CalculateGenotypePosteriors \\\n   -R reference.fasta \\\n   -V NA12878.wgs.HC.vcf \\\n   -supporting 1000G_EUR.genotypes.combined.vcf \\\n   -o NA12878.wgs.HC.posteriors.vcf \n </pre>\n\n <h4>Refine the genotypes of a large panel based on the discovered allele frequency</h4>\n <pre>\n java -jar GenomeAnalysisTK.jar \\\n   -T CalculateGenotypePosteriors \\\n   -R reference.fasta \\\n   -V input.vcf \\\n   -o output.withPosteriors.vcf\n </pre>\n\n <h4>Apply frequency and HWE-based priors to the genotypes of a family without including the family allele counts\n in the allele frequency estimates the genotypes of a large panel based on the discovered allele frequency</h4>\n <pre>\n java -jar GenomeAnalysisTK.jar \\\n   -T CalculateGenotypePosteriors \\\n   -R reference.fasta \\\n   -V input.vcf \\\n   -o output.withPosteriors.vcf \\\n   --ignoreInputSamples\n </pre>\n\n <h4>Calculate the posterior genotypes of a callset, and impose that a variant *not seen* in the external panel\n is tantamount to being AC=0, AN=100 within that panel</h4>\n <pre>\n java -jar GenomeAnalysisTK.jar \\\n   -T CalculateGenotypePosteriors \\\n   -R reference.fasta \\\n   -supporting external.panel.vcf \\\n   -V input.vcf \\\n   -o output.withPosteriors.vcf \\\n   --numRefSamplesIfNoCall 100\n </pre>\n\n <h4>Apply only family priors to a callset</h4>\n <pre>\n java -jar GenomeAnalysisTK.jar \\\n   -T CalculateGenotypePosteriors \\\n   -R reference.fasta \\\n   -V input.vcf \\\n   --skipPopulationPriors \\\n   -ped family.ped \\\n   -o output.withPosteriors.vcf\n </pre>",
    "group": "Variant Evaluation and Manipulation Tools",
    "name": "CalculateGenotypePosteriors",
    "annotinfo": "",
    "walkertype": "LocusWalker",
    "annotfield": "",
    "parallel": [],
    "arguments": [
        {
            "required": "no",
            "summary": "Use the AC field as opposed to MLEAC. Does nothing if VCF lacks MLEAC field",
            "synonyms": "-useAC",
            "maxValue": "NA",
            "fulltext": "Rather than looking for the MLEAC field first, and then falling back to AC; first look for the AC field and then\n fall back to MLEAC or raw genotypes",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_flag",
            "type": "boolean",
            "minRecValue": "NA",
            "name": "--defaultToAC",
            "rodTypes": "NA",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "no",
            "summary": "The de novo mutation prior",
            "synonyms": "-DNP",
            "maxValue": "Infinity",
            "fulltext": "The mutation prior -- i.e. the probability that a new mutation occurs. Sensitivity analysis on known de novo \n mutations suggests a default value of 10^-6.",
            "maxRecValue": "NA",
            "defaultValue": "1.0E-6",
            "kind": "optional_param",
            "type": "double",
            "minRecValue": "NA",
            "name": "--deNovoPrior",
            "rodTypes": "NA",
            "minValue": "-Infinity",
            "options": []
        },
        {
            "required": "no",
            "summary": "Do not use discovered allele count in the input callset for variants that do not appear in the external callset. ",
            "synonyms": "-useACoff",
            "maxValue": "NA",
            "fulltext": "Calculate priors for missing external variants from sample data -- default behavior is to apply flat priors",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_flag",
            "type": "boolean",
            "minRecValue": "NA",
            "name": "--discoveredACpriorsOff",
            "rodTypes": "NA",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "no",
            "summary": "The global Dirichlet prior parameters for the allele frequency",
            "synonyms": "-G",
            "maxValue": "Infinity",
            "fulltext": "The global prior of a variant site -- i.e. the expected allele frequency distribution knowing only that N alleles\n exist, and having observed none of them. This is the \"typical\" 1/x trend, modeled here as not varying\n across alleles. The calculation for this parameter is (Effective population size) * (steady state mutation rate)",
            "maxRecValue": "NA",
            "defaultValue": "0.001",
            "kind": "optional_param",
            "type": "double",
            "minRecValue": "NA",
            "name": "--globalPrior",
            "rodTypes": "NA",
            "minValue": "-Infinity",
            "options": []
        },
        {
            "required": "no",
            "summary": "Use external information only; do not inform genotype priors by the discovered allele frequency in the callset whose posteriors are being calculated. Useful for callsets containing related individuals.",
            "synonyms": "-ext",
            "maxValue": "NA",
            "fulltext": "Do not use the [MLE] allele count from the input samples (the ones for which you're calculating posteriors)\n in the site frequency distribution; only use the AC and AN calculated from external sources.",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_flag",
            "type": "boolean",
            "minRecValue": "NA",
            "name": "--ignoreInputSamples",
            "rodTypes": "NA",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "no",
            "summary": "The number of homozygous reference to infer were seen at a position where an \"other callset\" contains no site or genotype information",
            "synonyms": "-nrs",
            "maxValue": "Infinity",
            "fulltext": "When a variant is not seen in a panel, whether to infer (and with what effective strength) that only reference\n alleles were ascertained at that site. E.g. \"If not seen in 1000Genomes, treat it as AC=0, AN=2000\". This is\n applied across all external panels, so if numRefIsMissing = 10, and the variant is absent in two panels, this\n confers evidence of AC=0,AN=20",
            "maxRecValue": "NA",
            "defaultValue": "0",
            "kind": "optional_param",
            "type": "int",
            "minRecValue": "NA",
            "name": "--numRefSamplesIfNoCall",
            "rodTypes": "NA",
            "minValue": "-Infinity",
            "options": []
        },
        {
            "required": "no",
            "summary": "File to which variants should be written",
            "synonyms": "-o",
            "maxValue": "NA",
            "fulltext": "",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_out",
            "type": "VariantContextWriter",
            "minRecValue": "NA",
            "name": "--out",
            "rodTypes": "NA",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "no",
            "summary": "Skip application of family-based priors",
            "synonyms": "-skipFam",
            "maxValue": "NA",
            "fulltext": "Skip application of family-based priors.  Note: if pedigree file is absent, family-based priors will be skipped.",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_flag",
            "type": "boolean",
            "minRecValue": "NA",
            "name": "--skipFamilyPriors",
            "rodTypes": "NA",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "no",
            "summary": "Skip application of population-based priors",
            "synonyms": "-skipPop",
            "maxValue": "NA",
            "fulltext": "Skip application of population-based priors",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_flag",
            "type": "boolean",
            "minRecValue": "NA",
            "name": "--skipPopulationPriors",
            "rodTypes": "NA",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "no",
            "summary": "Other callsets to use in generating genotype posteriors",
            "synonyms": "-supporting",
            "maxValue": "NA",
            "fulltext": "Supporting external panels. Allele counts from these panels (taken from AC,AN or MLEAC,AN or raw genotypes) will\n be used to inform the frequency distribution underying the genotype priors. These files must be VCF 4.2 spec or later.",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "optional_in",
            "type": "List[RodBinding[VariantContext]]",
            "minRecValue": "NA",
            "name": "--supporting",
            "rodTypes": "<a href=htsjdk_variant_bcf2_BCF2Codec.php>BCF2</a>, <a href=htsjdk_variant_vcf_VCFCodec.php>VCF</a>, <a href=htsjdk_variant_vcf_VCF3Codec.php>VCF3</a>",
            "minValue": "NA",
            "options": []
        },
        {
            "required": "yes",
            "summary": "Input VCF file",
            "synonyms": "-V",
            "maxValue": "NA",
            "fulltext": "Variants from this VCF file are used by this tool as input.\n The file must at least contain the standard VCF header lines, but\n can be empty (i.e., no variants are contained in the file).",
            "maxRecValue": "NA",
            "defaultValue": "NA",
            "kind": "required_in",
            "type": "RodBinding[VariantContext]",
            "minRecValue": "NA",
            "name": "--variant",
            "rodTypes": "<a href=htsjdk_variant_bcf2_BCF2Codec.php>BCF2</a>, <a href=htsjdk_variant_vcf_VCFCodec.php>VCF</a>, <a href=htsjdk_variant_vcf_VCF3Codec.php>VCF3</a>",
            "minValue": "NA",
            "options": []
        }
    ],
    "readfilters": [
        {
            "filename": "org_broadinstitute_gatk_engine_filters_MalformedReadFilter.php",
            "name": "MalformedReadFilter"
        },
        {
            "filename": "org_broadinstitute_gatk_engine_filters_BadCigarFilter.php",
            "name": "BadCigarFilter"
        },
        {
            "filename": "org_broadinstitute_gatk_engine_filters_UnmappedReadFilter.php",
            "name": "UnmappedReadFilter"
        },
        {
            "filename": "org_broadinstitute_gatk_engine_filters_NotPrimaryAlignmentFilter.php",
            "name": "NotPrimaryAlignmentFilter"
        },
        {
            "filename": "org_broadinstitute_gatk_engine_filters_FailsVendorQualityCheckFilter.php",
            "name": "FailsVendorQualityCheckFilter"
        },
        {
            "filename": "org_broadinstitute_gatk_engine_filters_DuplicateReadFilter.php",
            "name": "DuplicateReadFilter"
        }
    ],
    "activeregion": {},
    "partitiontype": "LOCUS"
}